# Distributed Transaction Business Flowcharts (English Version)

## Flowchart Symbols Legend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Rectangleâ”‚  = Process/Operation
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â—‡ Diamond = Decision Point

â¬­ Rounded Rectangle = Start/End

â•‘ Document Symbol = Data/Document

â¬¡ Hexagon = Preparation/Initialize

â†’ Arrow = Flow Direction

// Comment text
```

---

## Flowchart 1: ACID Transaction (Two-Phase Commit)

### Main Flow

```
        â¬­ Start
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Customer     â”‚
    â”‚Places Order â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â¬¡ Initialize Distributed Transaction
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Coordinator   â”‚
    â”‚Starts        â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Phase 1: PREPARE         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â†“          â†“          â†“          â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Order      â”‚ â”‚Payment   â”‚ â”‚Inventory  â”‚
    â”‚Service    â”‚ â”‚Service   â”‚ â”‚Service    â”‚
    â”‚Prepare TX â”‚ â”‚Prepare TXâ”‚ â”‚Prepare TX â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚            â”‚              â”‚
          â”‚  ğŸ”’Lock    â”‚  ğŸ”’Lock     â”‚  ğŸ”’Lock
          â”‚  Resources â”‚  Resources  â”‚  Resources
          â”‚            â”‚              â”‚
          â†“            â†“              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Check      â”‚ â”‚Check     â”‚ â”‚Check      â”‚
    â”‚Feasibilityâ”‚ â”‚Balance   â”‚ â”‚Stock      â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚            â”‚              â”‚
          â†“            â†“              â†“
         â—‡            â—‡              â—‡
        /OK?\        /OK?\          /OK?\
       /    \       /    \         /    \
     YES    NO    YES    NO      YES    NO
      â”‚      â”‚     â”‚      â”‚       â”‚      â”‚
      â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            Return READY / ABORT
                    â”‚
                    â†“
             â—‡ Coordinator Decides
            / All READY? \
           /             \
         YES              NO
          â”‚               â”‚
          â†“               â†“
    â•”â•â•â•â•â•â•â•â•â•â•â•â•—   â•”â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  Phase 2  â•‘   â•‘  Phase 2  â•‘
    â•‘  COMMIT   â•‘   â•‘  ABORT    â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•   â•šâ•â•â•â•â•â•â•â•â•â•â•â•
          â”‚               â”‚
          â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Send      â”‚    â”‚Send      â”‚
    â”‚COMMIT to â”‚    â”‚ABORT to  â”‚
    â”‚All       â”‚    â”‚All       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Services  â”‚    â”‚Services  â”‚
    â”‚Commit    â”‚    â”‚Rollback  â”‚
    â”‚Release   â”‚    â”‚Release   â”‚
    â”‚Locks     â”‚    â”‚Locks     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â†“               â†“
      â¬­ Success      â¬­ Failed
```

### Problem Scenario Flow

```
    â¬­ Start Transaction
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Phase 1      â”‚
    â”‚In Progress..â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
       â—‡ Coordinator Status
      / Normal? \
     /           \
   YES            NO
    â”‚             â”‚
    â”‚             â†“
    â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      â”‚Coordinator   â”‚
    â”‚      â”‚Crashes       â”‚ âš ï¸
    â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚
    â”‚             â†“
    â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      â”‚All Services  â”‚
    â”‚      â”‚Hold Locks ğŸ”’ â”‚
    â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚
    â”‚             â†“
    â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      â”‚Cannot Releaseâ”‚
    â”‚      â”‚Stuck Waiting â”‚ âŒ
    â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚
    â”‚             â†“
    â”‚      â¬­ System Blocked
    â”‚
    â†“
  (Continue Normal Flow)
```

---

## Flowchart 2: Saga Orchestration Pattern

### Success Path Flowchart

```
        â¬­ Customer Places Order
                  â”‚
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚Saga          â”‚
           â”‚Orchestrator  â”‚
           â”‚Starts TX     â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  Step 1:     â”‚
           â”‚Create Order  â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚OrderService  â”‚
           â”‚Execute Local â”‚
           â”‚Transaction   â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
              â—‡ Success?
             /           \
           YES            NO â”€â”€â”€â”€â”€â”€â”
            â”‚                      â”‚
            â†“                      â”‚
       â•‘ Save State â•‘              â”‚
        orderId: 123               â”‚
            â”‚                      â”‚
            â†“                      â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
       â”‚  Step 2:     â”‚            â”‚
       â”‚Process       â”‚            â”‚
       â”‚Payment       â”‚            â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
              â”‚                    â”‚
              â†“                    â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
       â”‚PaymentServiceâ”‚            â”‚
       â”‚Execute Local â”‚            â”‚
       â”‚Transaction   â”‚            â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
              â”‚                    â”‚
              â†“                    â”‚
          â—‡ Success?               â”‚
         /           \             â”‚
       YES            NO â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚                      â”‚   â”‚
        â†“                      â”‚   â”‚
   â•‘ Save State â•‘              â”‚   â”‚
    paymentId: P456            â”‚   â”‚
        â”‚                      â”‚   â”‚
        â†“                      â”‚   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
   â”‚  Step 3:     â”‚            â”‚   â”‚
   â”‚Reserve       â”‚            â”‚   â”‚
   â”‚Inventory     â”‚            â”‚   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
          â”‚                    â”‚   â”‚
          â†“                    â”‚   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
   â”‚InventoryServiceâ”‚          â”‚   â”‚
   â”‚Execute Local â”‚            â”‚   â”‚
   â”‚Transaction   â”‚            â”‚   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
          â”‚                    â”‚   â”‚
          â†“                    â”‚   â”‚
      â—‡ Success?               â”‚   â”‚
     /           \             â”‚   â”‚
   YES            NO           â”‚   â”‚
    â”‚             â”‚            â”‚   â”‚
    â†“             â†“            â†“   â†“
â•‘ Save State â•‘   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
reservationId: R789 â•‘Trigger          â•‘
    â”‚              â•‘Compensation     â•‘
    â†“              â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  Step 4:     â”‚           â”‚
â”‚Confirm Order â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                   â”‚
       â†“                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚OrderService  â”‚           â”‚
â”‚Update Status â”‚           â”‚
â”‚= CONFIRMED   â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                   â”‚
       â†“                   â”‚
   â¬­ Order Success         â”‚
                           â”‚
                           â†“
                    (Jump to Compensation)
```

### Compensation Flow (Payment Failed)

```
    â¬­ Payment Failed
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Detect Failureâ”‚
    â”‚paymentId=nullâ”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Orchestrator  â”‚
    â”‚Trigger       â”‚
    â”‚Compensation  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘Start Compensation (Reverse)â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Compensate Step 1:â”‚
    â”‚Cancel Order      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚OrderService  â”‚
    â”‚CancelOrder() â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Update Order  â”‚
    â”‚Status =      â”‚
    â”‚CANCELLED     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
       â—‡ Compensation Success?
      /                    \
    YES                     NO
     â”‚                      â”‚
     â†“                      â†“
â•‘ Record â•‘           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Status:             â”‚Record    â”‚
 Cancelled           â”‚Failure   â”‚
     â”‚               â”‚Manual    â”‚âš ï¸
     â”‚               â”‚Interventionâ”‚
     â”‚               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                    â”‚
     â†“                    â†“
 â¬­ Compensation      â¬­ Needs
    Complete            Handling
```

### Compensation Flow (Inventory Failed - Multi-Step)

```
    â¬­ Inventory Failed
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Executed Steps:â”‚
    â”‚âœ“ Order Createdâ”‚
    â”‚âœ“ Payment Doneâ”‚
    â”‚âœ— Inventory   â”‚
    â”‚  Failed      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘Start Compensation (Reverse)â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Compensate Step 1:â”‚
    â”‚Refund Payment    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚PaymentServiceâ”‚
    â”‚RefundPayment()â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Execute Refundâ”‚
    â”‚paymentId:P456â”‚
    â”‚amount: $50   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
       â—‡ Refund Success?
      /              \
    YES               NO
     â”‚                â”‚
     â†“                â†“
â•‘ Record: â•‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Refund            â”‚Refund    â”‚âš ï¸
 Success           â”‚Failed    â”‚
     â”‚             â”‚Trigger   â”‚
     â”‚             â”‚Retry     â”‚
     â”‚             â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚
     â”‚                  â†“
     â”‚             â—‡ Retry Success?
     â”‚            /              \
     â”‚          YES               NO
     â”‚           â”‚                â”‚
     â”‚           â†“                â†“
     â”‚       (Continue)    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                     â”‚Mark as   â”‚
     â”‚                     â”‚Manual    â”‚
     â”‚                     â”‚Handling  â”‚
     â”‚                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                          â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Compensate Step 2:â”‚
â”‚Cancel Order      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚OrderService  â”‚
    â”‚CancelOrder() â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Update Status â”‚
    â”‚= CANCELLED   â”‚
    â”‚Reason:       â”‚
    â”‚Out of Stock  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
       â—‡ Cancel Success?
      /                \
    YES                 NO
     â”‚                  â”‚
     â†“                  â†“
â•‘ Compensation â•‘  âš ï¸ Data Inconsistency
   Complete           Manual Intervention
     â”‚                   Required
     â†“
 â¬­ Order Failed
  (Compensated)
```

---

## Flowchart 3: Saga Choreography Pattern (Event-Driven)

### Success Path Flowchart

```
        â¬­ Customer Places Order
                  â”‚
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ OrderService â”‚
           â”‚ Receive      â”‚
           â”‚ Request      â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Create Local â”‚
           â”‚ Order        â”‚
           â”‚Status=PENDINGâ”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Publish Eventâ”‚
           â”‚OrderCreated  â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
           â•‘ Event Bus â•‘
                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          â”‚               â”‚
          â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Payment   â”‚   â”‚Inventory  â”‚
    â”‚Service   â”‚   â”‚Service    â”‚
    â”‚Listens   â”‚   â”‚Listens    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â”‚(Executes First)â”‚
         â†“               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚PaymentServiceâ”‚     â”‚
    â”‚Process       â”‚     â”‚
    â”‚Payment       â”‚     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
           â”‚             â”‚
           â†“             â”‚
       â—‡ Payment Success?â”‚
      /                \ â”‚
    YES                NOâ”‚
     â”‚                 â”‚ â”‚
     â†“                 â”‚ â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚Publish Event â”‚       â”‚ â”‚
â”‚Payment       â”‚       â”‚ â”‚
â”‚Processed     â”‚       â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
       â”‚               â”‚ â”‚
       â†“               â”‚ â”‚
  â•‘ Event Bus â•‘        â”‚ â”‚
       â”‚               â”‚ â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”˜
                       â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                     â”‚
          â†“                     â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Inventory â”‚         â”‚Payment   â”‚
    â”‚Service   â”‚         â”‚Failed    â”‚
    â”‚Listens   â”‚         â”‚Event     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      (Jump to Failure Flow)
â”‚Reserve       â”‚
â”‚Inventory     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
   â—‡ Reserve Success?
  /                 \
YES                  NO
 â”‚                   â”‚
 â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  (Jump to Failure Flow)
â”‚Publish Event â”‚
â”‚Inventory     â”‚
â”‚Reserved      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
  â•‘ Event Bus â•‘
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OrderService â”‚
â”‚ Listens      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Statusâ”‚
â”‚ = COMPLETED  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Publish Event â”‚
â”‚Order         â”‚
â”‚Completed     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
   â¬­ Order Success
```

### Failure Compensation Flow (Payment Failed)

```
    â¬­ Payment Failed Point
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚PaymentServiceâ”‚
    â”‚Payment Failedâ”‚
    â”‚Reason:       â”‚
    â”‚Insufficient  â”‚
    â”‚Funds         â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Publish Eventâ”‚
    â”‚PaymentFailed â”‚
    â”‚{orderId,     â”‚
    â”‚ reason}      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â•‘ Event Bus â•‘
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ OrderService â”‚
    â”‚ Listen to    â”‚
    â”‚ Failed Event â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Execute      â”‚
    â”‚ Compensation â”‚
    â”‚ Cancel Order â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Update Local â”‚
    â”‚ Status =     â”‚
    â”‚ CANCELLED    â”‚
    â”‚ Reason:      â”‚
    â”‚ Payment      â”‚
    â”‚ Failed       â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Publish Eventâ”‚
    â”‚Order         â”‚
    â”‚Cancelled     â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â•‘ Event Bus â•‘
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Other        â”‚
    â”‚ Services     â”‚
    â”‚ May Listen   â”‚
    â”‚(Notification)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
   â¬­ Compensation Complete
```

### Failure Compensation Flow (Inventory Failed - Cascading)

```
    â¬­ Inventory Failed Point
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚InventoryServiceâ”‚
    â”‚Stock Check     â”‚
    â”‚Failed          â”‚
    â”‚Reason: Out of  â”‚
    â”‚Stock           â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Publish Eventâ”‚
    â”‚Inventory     â”‚
    â”‚Unavailable   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â†“
    â•‘ Event Bus â•‘
           â”‚
     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â”‚           â”‚
     â†“           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Payment   â”‚ â”‚Order     â”‚
â”‚Service   â”‚ â”‚Service   â”‚
â”‚Listens   â”‚ â”‚Listens   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚
     â†“            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚PaymentServiceâ”‚  â”‚
â”‚Trigger       â”‚  â”‚
â”‚Compensation  â”‚  â”‚
â”‚Execute Refundâ”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
       â”‚          â”‚
       â†“          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚RefundPayment â”‚  â”‚
â”‚paymentId:P456â”‚  â”‚
â”‚amount: $50   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
       â”‚          â”‚
       â†“          â”‚
   â—‡ Refund Success?â”‚
  /              \  â”‚
YES              NO â”‚
 â”‚               â”‚  â”‚
 â†“               â†“  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Publish Event â”‚ â”‚Mark      â”‚âš ï¸
â”‚Payment       â”‚ â”‚Failed    â”‚
â”‚Refunded      â”‚ â”‚Manual    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚Interventionâ”‚
       â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â†“              â”‚
  â•‘ Event Bus â•‘       â†“
       â”‚          â¬­ Needs
       â†“             Handling
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OrderService â”‚
â”‚ Listens      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Execute       â”‚
â”‚Compensation  â”‚
â”‚Cancel Order  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Update Local  â”‚
â”‚Status =      â”‚
â”‚CANCELLED     â”‚
â”‚Reason:       â”‚
â”‚Out of Stock  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Publish Event â”‚
â”‚Order         â”‚
â”‚Cancelled     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
  â•‘ Event Bus â•‘
       â”‚
       â†“
   â¬­ Compensation Complete
```

---

## Flowchart 4: Decision Flow (Choosing Pattern)

```
        â¬­ Start Designing Distributed Transaction
                        â”‚
                        â†“
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Analyze      â”‚
                 â”‚ Requirements â”‚
                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
                 â—‡ Microservices Architecture?
                /                           \
              NO                            YES
               â”‚                             â”‚
               â†“                             â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â—‡ Strong Consistency Required?
         â”‚Use       â”‚              /                            \
         â”‚Traditionalâ”‚            YES                            NO
         â”‚ACID TX   â”‚             â”‚                              â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â†“                              â†“
              â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â—‡ Number of Services?
              â”‚            â”‚âŒ Not        â”‚             /                    \
              â”‚            â”‚Suitable for  â”‚          Few(2-5)            Many(5+)
              â”‚            â”‚Microservices â”‚            â”‚                    â”‚
              â”‚            â”‚Reconsider    â”‚            â†“                    â†“
              â”‚            â”‚Requirements  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  Saga    â”‚        â”‚  Saga    â”‚
              â”‚                                 â”‚Orchestra-â”‚        â”‚Choreo-   â”‚
              â”‚                                 â”‚tion      â”‚        â”‚graphy    â”‚
              â”‚                                 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
              â”‚                                      â”‚                   â”‚
              â”‚                                      â†“                   â†“
              â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                            â”‚Pros:          â”‚   â”‚Pros:          â”‚
              â”‚                            â”‚- Easy debug   â”‚   â”‚- High         â”‚
              â”‚                            â”‚- Clear flow   â”‚   â”‚  availability â”‚
              â”‚                            â”‚- Central      â”‚   â”‚- Scalable     â”‚
              â”‚                            â”‚  control      â”‚   â”‚- Loose        â”‚
              â”‚                            â”‚               â”‚   â”‚  coupling     â”‚
              â”‚                            â”‚Cons:          â”‚   â”‚               â”‚
              â”‚                            â”‚- Orchestrator â”‚   â”‚Cons:          â”‚
              â”‚                            â”‚  SPOF         â”‚   â”‚- Hard to      â”‚
              â”‚                            â”‚- Medium       â”‚   â”‚  debug        â”‚
              â”‚                            â”‚  complexity   â”‚   â”‚- High         â”‚
              â”‚                            â”‚               â”‚   â”‚  complexity   â”‚
              â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                    â”‚                   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â†“
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                            â”‚ Implement    â”‚
                                            â”‚ Selected     â”‚
                                            â”‚ Approach     â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â†“
                                               â¬­ Complete
```

---

## Flowchart 5: Exception Handling Flow

```
        â¬­ Transaction Executing
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Execute      â”‚
         â”‚ Business Stepâ”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
            â—‡ Exception Occurred?
           /                      \
         NO                       YES
          â”‚                        â”‚
          â†“                        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Continue  â”‚           â”‚ Classify     â”‚
    â”‚Next Step â”‚           â”‚ Exception    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â”‚ Type         â”‚
         â”‚                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                        â”‚
         â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â†“        â†“        â†“
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”
         â”‚         â”‚Business  â”‚ â”‚Tech   â”‚ â”‚Timeoutâ”‚
         â”‚         â”‚Exception â”‚ â”‚Error  â”‚ â”‚Error  â”‚
         â”‚         â”‚(e.g. Out â”‚ â”‚       â”‚ â”‚       â”‚
         â”‚         â”‚of Stock) â”‚ â”‚       â”‚ â”‚       â”‚
         â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚              â”‚           â”‚         â”‚
         â”‚              â†“           â†“         â†“
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”
         â”‚         â”‚Trigger   â”‚ â”‚Retry? â”‚ â”‚Retry? â”‚
         â”‚         â”‚Compen-   â”‚ â”‚       â”‚ â”‚       â”‚
         â”‚         â”‚sation    â”‚ â”‚       â”‚ â”‚       â”‚
         â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚              â”‚           â”‚         â”‚
         â”‚              â†“           â†“         â†“
         â”‚         â•”â•â•â•â•â•â•â•â•â•â•â•â•—  â—‡        â—‡
         â”‚         â•‘Compensationâ•‘  /Retry\ /Retry\
         â”‚         â•‘Transaction â•‘  Success? Success?
         â”‚         â•‘Flow       â•‘  â”‚  â”‚    â”‚  â”‚
         â”‚         â•šâ•â•â•â•â•â•â•â•â•â•â•â• YES NO  YES NO
         â”‚              â”‚         â”‚  â”‚    â”‚  â”‚
         â”‚              â†“         â†“  â†“    â†“  â†“
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”(Continue)(Compensate)(Continue)(Compensate)
         â”‚         â”‚Execute   â”‚
         â”‚         â”‚Compen-   â”‚
         â”‚         â”‚sations   â”‚
         â”‚         â”‚in Reverseâ”‚
         â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â”‚              â†“
         â”‚          â—‡ Compensation Success?
         â”‚         /                        \
         â”‚       YES                         NO
         â”‚        â”‚                          â”‚
         â”‚        â†“                          â†“
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚Record    â”‚            â”‚Mark for  â”‚
         â”‚   â”‚State     â”‚            â”‚Manual    â”‚âš ï¸
         â”‚   â”‚Compen-   â”‚            â”‚Interventionâ”‚
         â”‚   â”‚sated     â”‚            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                 â”‚
         â”‚        â”‚                       â†“
         â”‚        â†“                   â¬­ Needs
         â”‚    â¬­ Failed                  Manual
         â”‚   (Compensated)               Handling
         â”‚
         â†“
    â—‡ All Steps Completed?
   /                        \
 YES                         NO
  â”‚                          â”‚
  â†“                          â”‚
â¬­ Transaction Success        â”‚
                             â””â”€(Return to Execute)
```

---

## Flowchart 6: Monitoring and Recovery Flow

```
        â¬­ System Running
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Monitor      â”‚
         â”‚ Transaction  â”‚
         â”‚ Status       â”‚
         â”‚(Continuous)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
            â—‡ Anomaly Detected?
           /                    \
         NO                     YES
          â”‚                      â”‚
          â†“                      â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Continue  â”‚          â”‚ Log Exceptionâ”‚
    â”‚Monitoringâ”‚          â”‚ Information  â”‚
    â”‚(Polling) â”‚          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                 â”‚
         â”‚                       â†“
         â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                â”‚ Analyze      â”‚
         â”‚                â”‚ Exception    â”‚
         â”‚                â”‚ Type         â”‚
         â”‚                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              â†“        â†“        â†“
         â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
         â”‚        â”‚Incompleteâ”‚ â”‚TX    â”‚ â”‚Data  â”‚
         â”‚        â”‚Compen-   â”‚ â”‚Timeoutâ”‚Incon- â”‚
         â”‚        â”‚sation    â”‚ â”‚      â”‚sistencyâ”‚
         â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜
         â”‚             â”‚          â”‚        â”‚
         â”‚             â†“          â†“        â†“
         â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      â”‚Resume    â”‚ â”‚Retry   â”‚ â”‚Invoke  â”‚
         â”‚      â”‚Compen-   â”‚ â”‚TX      â”‚ â”‚Recon-  â”‚
         â”‚      â”‚sation    â”‚ â”‚        â”‚ â”‚ciliationâ”‚
         â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚           â”‚           â”‚          â”‚
         â”‚           â†“           â†“          â†“
         â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      â”‚Execute   â”‚ â”‚Re-     â”‚ â”‚Compare â”‚
         â”‚      â”‚Remaining â”‚ â”‚execute â”‚ â”‚States  â”‚
         â”‚      â”‚Steps     â”‚ â”‚Failed  â”‚ â”‚Across  â”‚
         â”‚      â”‚          â”‚ â”‚Step    â”‚ â”‚Servicesâ”‚
         â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚           â”‚           â”‚          â”‚
         â”‚           â†“           â†“          â†“
         â”‚       â—‡ Success?  â—‡ Success? â—‡ Match?
         â”‚      /         \ /         \/        \
         â”‚    YES         NO YES      NO YES     NO
         â”‚     â”‚          â”‚  â”‚        â”‚  â”‚       â”‚
         â”‚     â†“          â†“  â†“        â†“  â†“       â†“
         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”
         â”‚ â”‚Log     â”‚ â”‚Alertâ”‚ â”‚Log â”‚â”‚Alertâ”‚Logâ”‚â”‚Alertâ”‚
         â”‚ â”‚Success â”‚ â”‚Ops  â”‚âš ï¸â”‚OK  â”‚â”‚Ops â”‚âš ï¸â”‚OKâ”‚â”‚Opsâ”‚âš ï¸
         â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”¬â”€â”€â”˜â””â”€â”¬â”€â”˜â””â”€â”¬â”€â”˜â””â”€â”¬â”€â”˜
         â”‚     â”‚         â”‚      â”‚    â”‚   â”‚   â”‚
         â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
         â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Update       â”‚
                         â”‚ Monitoring   â”‚
                         â”‚ Dashboard    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â†“
                            â¬­ Recovery
                             Attempted
```

---

## Flowchart 7: Comparison Matrix (Table Format)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Feature       â”‚ ACID (2PC)   â”‚   Saga       â”‚   Saga       â”‚
â”‚                 â”‚              â”‚Orchestration â”‚Choreography  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Coordination    â”‚ Centralized  â”‚ Centralized  â”‚ Decentralizedâ”‚
â”‚ Method          â”‚ Coordinator  â”‚ Orchestrator â”‚ Event-Driven â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Consistency     â”‚ Strong       â”‚ Eventual     â”‚ Eventual     â”‚
â”‚                 â”‚ (ACID)       â”‚              â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Availability    â”‚ âŒ Low        â”‚ âœ… High       â”‚ âœ… Very High  â”‚
â”‚                 â”‚ (Blocking)   â”‚              â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Complexity      â”‚ Low          â”‚ Medium       â”‚ High         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Single Point    â”‚ âŒ Yes        â”‚ âš ï¸  Yes       â”‚ âœ… No         â”‚
â”‚ of Failure      â”‚ (Coordinator)â”‚(Orchestrator)â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Performance     â”‚ âŒ Poor       â”‚ âœ… Good       â”‚ âœ… Excellent  â”‚
â”‚                 â”‚ (Lock wait)  â”‚              â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Debugging       â”‚ Easy         â”‚ Medium       â”‚ âŒ Hard       â”‚
â”‚ Difficulty      â”‚              â”‚              â”‚ (Distributed)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Transaction     â”‚ Automatic    â”‚ Compensating â”‚ Compensating â”‚
â”‚ Rollback        â”‚ Rollback     â”‚ Transaction  â”‚ Transaction  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Use Case        â”‚ Monolithic/  â”‚ Medium-scale â”‚ Large-scale  â”‚
â”‚                 â”‚ Small-scale  â”‚ Microservicesâ”‚ Microservicesâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Coupling        â”‚ Tight        â”‚ Medium       â”‚ Loose        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Scalability     â”‚ âŒ Limited    â”‚ âœ… Good       â”‚ âœ… Excellent  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flowchart 8: CAP Theorem Triangle

```
                    Consistency (C)
                          â–³
                         â•±â”‚â•²
                        â•± â”‚ â•²
                       â•±  â”‚  â•²
                      â•±   â”‚   â•²
                     â•±    â”‚    â•²
                    â•± ACID(2PC)â•²
                   â•±     (CP)   â•²
                  â•±      â”‚       â•²
                 â•±       â”‚        â•²
                â•±â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²
               â–³         â”‚          â–³
         Availability    â”‚      Partition
              (A)        â”‚      Tolerance (P)
                         â”‚
                    Saga Pattern
                    (AP System)

Legend:
â”â”â”â”  Strong preference
â•Œâ•Œâ•Œâ•Œ  Weak/Sacrificed

ACID 2PC Position:
â€¢ Chooses: Consistency + Partition Tolerance (CP)
â€¢ Sacrifices: Availability (blocks during partitions)

Saga Position:
â€¢ Chooses: Availability + Partition Tolerance (AP)
â€¢ Sacrifices: Strong Consistency (eventual only)
```

---

## Flowchart 9: Use Case Recommendation Matrix

```
                    High Consistency Required
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
   High â”‚    âš ï¸ Difficult    â”‚    âœ… Saga        â”‚
   Availabilityâ”‚    Tradeoff      â”‚  Orchestrationâ”‚
   Required â”‚  (Reconsider)    â”‚   (Recommended)â”‚
        â”‚                   â”‚                   â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                   â”‚                   â”‚
   Low  â”‚   âŒ ACID (2PC)    â”‚   âœ… Simple       â”‚
   Availabilityâ”‚   (Not          â”‚   Async        â”‚
   Required â”‚   Recommended)   â”‚   (Good enough)â”‚
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    Low Consistency Required


Alternative View - Service Count Based:

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Few Services     â”‚  Many Services    â”‚
        â”‚  (2-5 services)   â”‚  (5+ services)    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  High  â”‚  âœ… Saga          â”‚  âœ… Saga          â”‚
  Cons- â”‚  Orchestration    â”‚  Choreography     â”‚
  isten-â”‚                   â”‚                   â”‚
  cy    â”‚  - Clear workflow â”‚  - Scalable       â”‚
        â”‚  - Easy debug     â”‚  - Loose coupling â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  Low   â”‚  âœ… Simple Async  â”‚  âœ… Event-Driven  â”‚
  Cons- â”‚                   â”‚                   â”‚
  isten-â”‚  - Minimal        â”‚  - Highly         â”‚
  cy    â”‚    complexity     â”‚    distributed    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flowchart 10: Real-World Examples

```
        â¬­ Choose Pattern Based on Domain

                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚
        â†“           â†“           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ACID 2PC  â”‚ â”‚  Saga    â”‚ â”‚  Saga    â”‚
â”‚  (Avoid in â”‚ â”‚Orchestra-â”‚ â”‚Choreo-   â”‚
â”‚  Micro-    â”‚ â”‚  tion    â”‚ â”‚  graphy  â”‚
â”‚  services) â”‚ â”‚          â”‚ â”‚          â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚             â”‚             â”‚
      â†“             â†“             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Only Use: â”‚  â”‚Examples: â”‚  â”‚Examples: â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚â€¢ Single  â”‚  â”‚â€¢ E-commerceâ”‚ â”‚â€¢ Netflix â”‚
â”‚  Databaseâ”‚  â”‚  Order    â”‚  â”‚  Video   â”‚
â”‚  TX      â”‚  â”‚  System   â”‚  â”‚  Pipelineâ”‚
â”‚          â”‚  â”‚           â”‚  â”‚          â”‚
â”‚â€¢ Monolithâ”‚  â”‚â€¢ Travel   â”‚  â”‚â€¢ Large   â”‚
â”‚  Internalâ”‚  â”‚  Booking  â”‚  â”‚  Logisticsâ”‚
â”‚  TX      â”‚  â”‚  (Flight+ â”‚  â”‚  System  â”‚
â”‚          â”‚  â”‚  Hotel)   â”‚  â”‚          â”‚
â”‚â€¢ NOT for â”‚  â”‚           â”‚  â”‚â€¢ IoT Dataâ”‚
â”‚  Distri- â”‚  â”‚â€¢ Financialâ”‚  â”‚  Proces- â”‚
â”‚  buted   â”‚  â”‚  Transfer â”‚  â”‚  sing    â”‚
â”‚  Systems â”‚  â”‚  with     â”‚  â”‚          â”‚
â”‚          â”‚  â”‚  Audit    â”‚  â”‚â€¢ Social  â”‚
â”‚          â”‚  â”‚  Trail    â”‚  â”‚  Media   â”‚
â”‚          â”‚  â”‚           â”‚  â”‚  Platformsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flowchart 11: Key Insights Summary

### Why ACID Doesn't Work for Microservices

```
        â¬­ ACID Transaction Starts
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Service A    â”‚
         â”‚ Locks        â”‚
         â”‚ Resources ğŸ”’ â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Coordinator  â”‚
         â”‚ Coordinates  â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Service B    â”‚
         â”‚ Locks        â”‚
         â”‚ Resources ğŸ”’ â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
            â—‡ Coordinator Crashes?
           /                       \
         NO                        YES
          â”‚                         â”‚
          â†“                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Continue  â”‚            â”‚ âŒ PROBLEM:   â”‚
    â”‚Normal    â”‚            â”‚               â”‚
    â”‚Flow      â”‚            â”‚â€¢ Services     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  blocked      â”‚
                            â”‚â€¢ Resources    â”‚
                            â”‚  locked       â”‚
                            â”‚â€¢ Cannot serve â”‚
                            â”‚  other requestsâ”‚
                            â”‚â€¢ System down  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â†“
                              â¬­ Unacceptable
                               in Production
```

### How Saga Solves This

```
        â¬­ Saga Transaction Starts
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Service A    â”‚
         â”‚ Local TX     â”‚
         â”‚ Commits      â”‚
         â”‚ Immediately  â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“ âœ… No locks held
                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Orchestrator â”‚
         â”‚ (or Event)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Service B    â”‚
         â”‚ Local TX     â”‚
         â”‚ Commits      â”‚
         â”‚ Immediately  â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“ âœ… No locks held
                â”‚
            â—‡ Step Fails?
           /              \
         NO               YES
          â”‚                â”‚
          â†“                â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Continue  â”‚    â”‚ âœ… SOLUTION:  â”‚
    â”‚to Next   â”‚    â”‚               â”‚
    â”‚Step      â”‚    â”‚â€¢ Execute      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  compensating â”‚
                    â”‚  transactions â”‚
                    â”‚â€¢ No resources â”‚
                    â”‚  locked       â”‚
                    â”‚â€¢ Services     â”‚
                    â”‚  available    â”‚
                    â”‚â€¢ Graceful     â”‚
                    â”‚  degradation  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â†“
                      â¬­ Acceptable
                       in Production
```

---

## Flowchart 12: Compensating Transaction Design

```
        â¬­ Design Forward Transaction
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Example:     â”‚
         â”‚ CreateOrder()â”‚
         â”‚              â”‚
         â”‚ Action:      â”‚
         â”‚ â€¢ Insert     â”‚
         â”‚   order      â”‚
         â”‚   record     â”‚
         â”‚ â€¢ Status=    â”‚
         â”‚   PENDING    â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Design       â”‚
         â”‚ Compensating â”‚
         â”‚ Transaction  â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ âš ï¸ NOT:      â”‚
         â”‚ DELETE order â”‚
         â”‚ (Technical   â”‚
         â”‚  rollback)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ âœ… INSTEAD:  â”‚
         â”‚ CancelOrder()â”‚
         â”‚              â”‚
         â”‚ Action:      â”‚
         â”‚ â€¢ UPDATE     â”‚
         â”‚   order      â”‚
         â”‚ â€¢ Status=    â”‚
         â”‚   CANCELLED  â”‚
         â”‚ â€¢ Reason=    â”‚
         â”‚   [why]      â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Why?         â”‚
         â”‚              â”‚
         â”‚ â€¢ Maintains  â”‚
         â”‚   audit trailâ”‚
         â”‚ â€¢ Preserve   â”‚
         â”‚   history    â”‚
         â”‚ â€¢ Business   â”‚
         â”‚   semantics  â”‚
         â”‚ â€¢ Compliance â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Key Principleâ”‚
         â”‚              â”‚
         â”‚ Compensation â”‚
         â”‚ = Business   â”‚
         â”‚   Reversal   â”‚
         â”‚              â”‚
         â”‚ NOT          â”‚
         â”‚ = Technical  â”‚
         â”‚   Undo       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
            â¬­ Design Complete
```

---

## Flowchart 13: Trade-offs Summary

```
                    â¬­ Distributed Transaction Design
                              â”‚
                              â†“
                      â—‡ Choose Your Priority
                     /         â”‚         \
                    /          â”‚          \
                   /           â”‚           \
                  â†“            â†“            â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Consistency â”‚  â”‚Availabilityâ”‚ â”‚Simplicityâ”‚
        â”‚First       â”‚  â”‚First      â”‚  â”‚First     â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚               â”‚              â”‚
              â†“               â†“              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Use:        â”‚  â”‚Use:      â”‚  â”‚Use:      â”‚
        â”‚Saga        â”‚  â”‚Saga      â”‚  â”‚Async     â”‚
        â”‚Orchestra-  â”‚  â”‚Choreo-   â”‚  â”‚Messaging â”‚
        â”‚tion        â”‚  â”‚graphy    â”‚  â”‚          â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚               â”‚              â”‚
              â†“               â†“              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Tradeoff:   â”‚  â”‚Tradeoff: â”‚  â”‚Tradeoff: â”‚
        â”‚            â”‚  â”‚          â”‚  â”‚          â”‚
        â”‚+ Clear     â”‚  â”‚+ No SPOF â”‚  â”‚+ Easy    â”‚
        â”‚  workflow  â”‚  â”‚+ Highly  â”‚  â”‚  to      â”‚
        â”‚+ Audit     â”‚  â”‚  scalableâ”‚  â”‚  implementâ”‚
        â”‚  trail     â”‚  â”‚          â”‚  â”‚          â”‚
        â”‚            â”‚  â”‚          â”‚  â”‚          â”‚
        â”‚- Medium    â”‚  â”‚- Complex â”‚  â”‚- No      â”‚
        â”‚  complexityâ”‚  â”‚  debug   â”‚  â”‚  trans-  â”‚
        â”‚- Orchestra-â”‚  â”‚- No      â”‚  â”‚  action  â”‚
        â”‚  tor SPOF  â”‚  â”‚  central â”‚  â”‚  guaranteeâ”‚
        â”‚            â”‚  â”‚  view    â”‚  â”‚          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚              â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
                      â¬­ Implementation Starts
```

---

## Summary Flow: Complete Transaction Lifecycle

```
â¬­ START: Business Transaction Request
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: Transaction Initiation       â”‚
â”‚                                       â”‚
â”‚ â€¢ Receive request                     â”‚
â”‚ â€¢ Validate input                      â”‚
â”‚ â€¢ Generate transaction ID             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 2: Execute Steps                â”‚
â”‚                                       â”‚
â”‚ For each service:                     â”‚
â”‚   â—‡ Execute local transaction         â”‚
â”‚  /                          \         â”‚
â”‚ SUCCESS                    FAILURE    â”‚
â”‚  â”‚                          â”‚         â”‚
â”‚  â€¢ Commit locally          â€¢ Trigger â”‚
â”‚  â€¢ Record state            compensationâ”‚
â”‚  â€¢ Continue                â€¢ Stop     â”‚
â”‚                            forward    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
          â—‡ All Steps Successful?
         /                      \
       YES                       NO
        â”‚                        â”‚
        â†“                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 3A:       â”‚    â”‚ Phase 3B:       â”‚
â”‚ Success Path    â”‚    â”‚ Compensation    â”‚
â”‚                 â”‚    â”‚ Path            â”‚
â”‚ â€¢ Mark complete â”‚    â”‚                 â”‚
â”‚ â€¢ Send          â”‚    â”‚ â€¢ Execute       â”‚
â”‚   confirmation  â”‚    â”‚   compensations â”‚
â”‚ â€¢ Update        â”‚    â”‚   (reverse)     â”‚
â”‚   all states    â”‚    â”‚ â€¢ Mark failed   â”‚
â”‚ â€¢ Notify user   â”‚    â”‚ â€¢ Notify user   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 4: Monitoring & Recovery        â”‚
â”‚                                       â”‚
â”‚ â€¢ Log transaction outcome             â”‚
â”‚ â€¢ Update metrics                      â”‚
â”‚ â€¢ Check for anomalies                 â”‚
â”‚ â€¢ Trigger alerts if needed            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
        â¬­ END: Transaction Complete
```

---

## Quick Reference Card

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘      DISTRIBUTED TRANSACTION PATTERNS             â•‘
â•‘              QUICK REFERENCE                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ When to Use What?                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ Single Database/Monolith:                      â”‚
â”‚   âœ… Traditional ACID transactions              â”‚
â”‚                                                 â”‚
â”‚ 2-5 Microservices + Need Audit:                â”‚
â”‚   âœ… Saga Orchestration                         â”‚
â”‚                                                 â”‚
â”‚ 5+ Microservices + High Scale:                 â”‚
â”‚   âœ… Saga Choreography                          â”‚
â”‚                                                 â”‚
â”‚ Distributed Microservices + ACID:              â”‚
â”‚   âŒ Not recommended (2PC has issues)           â”‚
â”‚   ğŸ’¡ Reconsider requirements                    â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Key Design Principles                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ 1. Design compensations upfront                â”‚
â”‚ 2. Make operations idempotent                  â”‚
â”‚ 3. Use timeouts everywhere                     â”‚
â”‚ 4. Log everything for debugging                â”‚
â”‚ 5. Monitor transaction states                  â”‚
â”‚ 6. Plan for partial failures                   â”‚
â”‚ 7. Test failure scenarios                      â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Common Pitfalls to Avoid                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ âŒ Using DELETE for compensation               â”‚
â”‚    âœ… Use UPDATE with status change            â”‚
â”‚                                                 â”‚
â”‚ âŒ No idempotency                              â”‚
â”‚    âœ… Use transaction IDs                      â”‚
â”‚                                                 â”‚
â”‚ âŒ No timeout handling                         â”‚
â”‚    âœ… Set explicit timeouts                    â”‚
â”‚                                                 â”‚
â”‚ âŒ Synchronous chains                          â”‚
â”‚    âœ… Use async where possible                 â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---